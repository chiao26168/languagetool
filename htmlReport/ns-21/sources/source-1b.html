


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > SwJLanguageTool</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.languagetool.openoffice</a>
</div>

<h1>Coverage Summary for Class: SwJLanguageTool (org.languagetool.openoffice)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">SwJLanguageTool</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/18)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/70)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/108)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/* LanguageTool, a natural language style checker 
&nbsp; * Copyright (C) 2016 Daniel Naber (http://www.danielnaber.de)
&nbsp; * 
&nbsp; * This library is free software; you can redistribute it and/or
&nbsp; * modify it under the terms of the GNU Lesser General Public
&nbsp; * License as published by the Free Software Foundation; either
&nbsp; * version 2.1 of the License, or (at your option) any later version.
&nbsp; *
&nbsp; * This library is distributed in the hope that it will be useful,
&nbsp; * but WITHOUT ANY WARRANTY; without even the implied warranty of
&nbsp; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
&nbsp; * Lesser General Public License for more details.
&nbsp; *
&nbsp; * You should have received a copy of the GNU Lesser General Public
&nbsp; * License along with this library; if not, write to the Free Software
&nbsp; * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301
&nbsp; * USA
&nbsp; */
&nbsp;package org.languagetool.openoffice;
&nbsp;
&nbsp;import java.io.File;
&nbsp;import java.io.IOException;
&nbsp;import java.net.MalformedURLException;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.List;
&nbsp;import java.util.ResourceBundle;
&nbsp;import java.util.Set;
&nbsp;
&nbsp;import org.languagetool.AnalyzedSentence;
&nbsp;import org.languagetool.AnalyzedToken;
&nbsp;import org.languagetool.AnalyzedTokenReadings;
&nbsp;import org.languagetool.JLanguageTool;
&nbsp;import org.languagetool.Language;
&nbsp;import org.languagetool.MultiThreadedJLanguageTool;
&nbsp;import org.languagetool.UserConfig;
&nbsp;import org.languagetool.JLanguageTool.Level;
&nbsp;import org.languagetool.JLanguageTool.Mode;
&nbsp;import org.languagetool.JLanguageTool.ParagraphHandling;
&nbsp;import org.languagetool.gui.Configuration;
&nbsp;import org.languagetool.markup.AnnotatedTextBuilder;
&nbsp;import org.languagetool.openoffice.OfficeTools.RemoteCheck;
&nbsp;import org.languagetool.rules.CategoryId;
&nbsp;import org.languagetool.rules.Rule;
&nbsp;import org.languagetool.rules.RuleMatch;
&nbsp;
&nbsp;/**
&nbsp; * Class to switch between running LanguageTool in multi or single thread mode
&nbsp; * @since 4.6
&nbsp; * @author Fred Kruse
&nbsp; */
&nbsp;public class SwJLanguageTool {
&nbsp;  
<b class="nc">&nbsp;  private static final ResourceBundle MESSAGES = JLanguageTool.getMessageBundle();</b>
&nbsp;
&nbsp;  private final MultiThreadedJLanguageTool mlt;
&nbsp;  private final LORemoteLanguageTool rlt;
&nbsp;
&nbsp;  private boolean isMultiThread;
&nbsp;  private boolean isRemote;
&nbsp;  private JLanguageTool lt;
&nbsp;  private boolean doReset;
&nbsp;
&nbsp;  public SwJLanguageTool(Language language, Language motherTongue, UserConfig userConfig, 
<b class="nc">&nbsp;      Configuration config, List&lt;Rule&gt; extraRemoteRules, boolean testMode) throws MalformedURLException {</b>
<b class="nc">&nbsp;    isMultiThread = config.isMultiThread();</b>
<b class="nc">&nbsp;    isRemote = config.doRemoteCheck() &amp;&amp; !testMode;</b>
<b class="nc">&nbsp;    doReset = false;</b>
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      lt = null;</b>
<b class="nc">&nbsp;      mlt = null;</b>
<b class="nc">&nbsp;      rlt = new LORemoteLanguageTool(language, motherTongue, config, extraRemoteRules, userConfig);</b>
<b class="nc">&nbsp;      if (!rlt.remoteRun()) {</b>
<b class="nc">&nbsp;        MessageHandler.showMessage(MESSAGES.getString(&quot;loRemoteSwitchToLocal&quot;));</b>
<b class="nc">&nbsp;        isRemote = false;</b>
<b class="nc">&nbsp;        isMultiThread = false;</b>
<b class="nc">&nbsp;        lt = new JLanguageTool(language, motherTongue, null, userConfig);</b>
&nbsp;      }
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;      lt = null;</b>
<b class="nc">&nbsp;      mlt = new MultiThreadedJLanguageTool(language, motherTongue, userConfig);</b>
<b class="nc">&nbsp;      rlt = null;</b>
&nbsp;    } else {
<b class="nc">&nbsp;      lt = new JLanguageTool(language, motherTongue, null, userConfig);</b>
<b class="nc">&nbsp;      mlt = null;</b>
<b class="nc">&nbsp;      rlt = null;</b>
&nbsp;    }
&nbsp;  }
&nbsp;  
&nbsp;  /**
&nbsp;   * Return true if check is done by a remote server
&nbsp;   */
&nbsp;  public boolean isRemote() {
<b class="nc">&nbsp;    return isRemote;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Get all rules
&nbsp;   */
&nbsp;  public List&lt;Rule&gt; getAllRules() {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      return rlt.getAllRules();</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;      return mlt.getAllRules(); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      return lt.getAllRules(); </b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Get all active rules
&nbsp;   */
&nbsp;  public List&lt;Rule&gt; getAllActiveRules() {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      return rlt.getAllActiveRules();</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;        return mlt.getAllActiveRules(); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      return lt.getAllActiveRules(); </b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Get all active office rules
&nbsp;   */
&nbsp;  public List&lt;Rule&gt; getAllActiveOfficeRules() {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      return rlt.getAllActiveOfficeRules();</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;        return mlt.getAllActiveOfficeRules(); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      return lt.getAllActiveOfficeRules(); </b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Enable a rule by ID
&nbsp;   */
&nbsp;  public void enableRule(String ruleId) {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      rlt.enableRule(ruleId);</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;      mlt.enableRule(ruleId); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      lt.enableRule(ruleId); </b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Disable a rule by ID
&nbsp;   */
&nbsp;  public void disableRule(String ruleId) {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      rlt.disableRule(ruleId);</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;      mlt.disableRule(ruleId); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      lt.disableRule(ruleId); </b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Get disabled rules
&nbsp;   */
&nbsp;  public Set&lt;String&gt; getDisabledRules() {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      return rlt.getDisabledRules();</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;        return mlt.getDisabledRules(); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      return lt.getDisabledRules(); </b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Disable a category by ID
&nbsp;   */
&nbsp;  public void disableCategory(CategoryId id) {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      rlt.disableCategory(id);</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;        mlt.disableCategory(id); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      lt.disableCategory(id); </b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Activate language model (ngram) rules
&nbsp;   */
&nbsp;  public void activateLanguageModelRules(File indexDir) throws IOException {
<b class="nc">&nbsp;    if (!isRemote) {</b>
<b class="nc">&nbsp;      if (isMultiThread) {</b>
<b class="nc">&nbsp;        mlt.activateLanguageModelRules(indexDir); </b>
&nbsp;      } else {
<b class="nc">&nbsp;        lt.activateLanguageModelRules(indexDir); </b>
&nbsp;      }
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * check text by LT
&nbsp;   * default: check only grammar
&nbsp;   * local: LT checks only grammar (spell check is not implemented locally)
&nbsp;   * remote: spell checking is used for LT check dialog (is needed because method getAnalyzedSentence is not supported by remote check)
&nbsp;   */
&nbsp;  public List&lt;RuleMatch&gt; check(String text, boolean tokenizeText, ParagraphHandling paraMode) throws IOException {
<b class="nc">&nbsp;    return check(text, tokenizeText, paraMode, RemoteCheck.ONLY_GRAMMAR);</b>
&nbsp;  }
&nbsp;
&nbsp;  public List&lt;RuleMatch&gt; check(String text, boolean tokenizeText, ParagraphHandling paraMode, RemoteCheck checkMode) throws IOException {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      List&lt;RuleMatch&gt; ruleMatches = rlt.check(text, paraMode, checkMode);</b>
<b class="nc">&nbsp;      if (ruleMatches == null) {</b>
<b class="nc">&nbsp;        doReset = true;</b>
<b class="nc">&nbsp;        ruleMatches = new ArrayList&lt;&gt;();</b>
&nbsp;      }
<b class="nc">&nbsp;      return ruleMatches;</b>
&nbsp;    } else {
&nbsp;      Mode mode;
<b class="nc">&nbsp;      if (paraMode == ParagraphHandling.ONLYNONPARA) {</b>
<b class="nc">&nbsp;        mode = Mode.ALL_BUT_TEXTLEVEL_ONLY;</b>
<b class="nc">&nbsp;      } else if (paraMode == ParagraphHandling.ONLYPARA) {</b>
<b class="nc">&nbsp;        mode = Mode.TEXTLEVEL_ONLY;</b>
&nbsp;      } else {
<b class="nc">&nbsp;        mode = Mode.ALL;</b>
&nbsp;      }
<b class="nc">&nbsp;      if (isMultiThread) {</b>
<b class="nc">&nbsp;        synchronized(mlt) {</b>
<b class="nc">&nbsp;          return mlt.check(new AnnotatedTextBuilder().addText(text).build(), tokenizeText, paraMode, null, mode, Level.PICKY);</b>
<b class="nc">&nbsp;        }</b>
&nbsp;      } else {
<b class="nc">&nbsp;        return lt.check(new AnnotatedTextBuilder().addText(text).build(), tokenizeText, paraMode, null, mode, Level.PICKY);</b>
&nbsp;      }
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Get a list of tokens from a sentence
&nbsp;   * This Method may be used only for local checks
&nbsp;   * Returns null for remote checks
&nbsp;   */
&nbsp;  public List&lt;String&gt; sentenceTokenize(String text) {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      return null;</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;        return mlt.sentenceTokenize(text); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      return lt.sentenceTokenize(text); </b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Analyze sentence
&nbsp;   * This Method may be used only for local checks
&nbsp;   * Returns null for remote checks
&nbsp;   */
&nbsp;  public AnalyzedSentence getAnalyzedSentence(String sentence) throws IOException {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      return null;</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;        return mlt.getAnalyzedSentence(sentence); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      return lt.getAnalyzedSentence(sentence); </b>
&nbsp;    }
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * get the lemmas of a word
&nbsp;   * @throws IOException 
&nbsp;   */
&nbsp;  public List&lt;String&gt; getLemmasOfWord(String word) throws IOException {
<b class="nc">&nbsp;    List&lt;String&gt; lemmas = new ArrayList&lt;String&gt;();</b>
<b class="nc">&nbsp;    Language language = getLanguage();</b>
<b class="nc">&nbsp;    List&lt;String&gt; words = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;    words.add(word);</b>
<b class="nc">&nbsp;    List&lt;AnalyzedTokenReadings&gt; aTokens = language.getTagger().tag(words);</b>
<b class="nc">&nbsp;    for (AnalyzedTokenReadings aToken : aTokens) {</b>
<b class="nc">&nbsp;      List&lt;AnalyzedToken&gt; readings = aToken.getReadings();</b>
<b class="nc">&nbsp;      for (AnalyzedToken reading : readings) {</b>
<b class="nc">&nbsp;        String lemma = reading.getLemma();</b>
<b class="nc">&nbsp;        if (lemma != null) {</b>
<b class="nc">&nbsp;          lemmas.add(lemma);</b>
&nbsp;        }
<b class="nc">&nbsp;      }</b>
<b class="nc">&nbsp;    }</b>
<b class="nc">&nbsp;    return lemmas;</b>
&nbsp;  }
&nbsp;
&nbsp;  /**
&nbsp;   * Get the language from LT
&nbsp;   */
&nbsp;  public Language getLanguage() {
<b class="nc">&nbsp;    if (isRemote) {</b>
<b class="nc">&nbsp;      return rlt.getLanguage();</b>
<b class="nc">&nbsp;    } else if (isMultiThread) {</b>
<b class="nc">&nbsp;      return mlt.getLanguage(); </b>
&nbsp;    } else {
<b class="nc">&nbsp;      return lt.getLanguage(); </b>
&nbsp;    }
&nbsp;  }
&nbsp;  
&nbsp;  /**
&nbsp;   * Set reset flag
&nbsp;   */
&nbsp;  public boolean doReset() {
<b class="nc">&nbsp;    return doReset;</b>
&nbsp;  }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-02-20 19:41</div>
</div>
</body>
</html>
